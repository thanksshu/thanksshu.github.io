---
title: 正则表达式
layout: post
comments: true
tags:
    - RegExp
    - 正则表达式
categories:
    - 笔记
    - RegExp
date: 2020-04-08 20:24:34
updated:
permalink: /note/regex
---

# 正则表达式

存在于 `/` 与 `/` 之中，使用单个字符串来描述、匹配一系列符合某个句法规则的字符串。

<!-- more -->

其分为 basic (BRE), extended (ERE)，和 perl-compatible (PCRE) 三种

## PCRE 表达式

Perl Compatible Regular Expressions

### 锚点

-   `^` 匹配输入字符串的开始位置，如果设置了 RegExp 对象的 Multiline 属性，`^` 也匹配“\n”或“\r”之后的位置

-   `$` 匹配输入字符串的结束位置，如果设置了 RegExp 对象的 Multiline 属性，`$` 也匹配“\n”或“\r”之前的位置

    > `^$` 可以匹配空行

### 数量限定

-   `*` 匹配前面的子表达式零次或多次

-   `+` 匹配前面的子表达式一次或多次

-   `?` 匹配前面的子表达式零次或一次

-   `{n}` n 是一个非负整数，对前面的子表达式匹配确定的 n 次

-   `{n,}` n 是一个非负整数，至少对前面的子表达式匹配 n 次

-   `{n,m}` m 和 n 均为非负整数，指定对前面的子表达式匹配的数量区间

    > 在逗号和两个数之间不能有空格

-   `?` 非贪心量化（Non-greedy quantifiers）：当该字符紧跟在任何一个其他 [数量限定](#数量限定) 修饰符后面时，匹配模式是非贪婪的

    非贪婪模式尽可能少的匹配所搜索的字符串，而默认的贪婪模式则尽可能多的匹配所搜索的字符串:

    对于字符串“oooo”，“o+?”将匹配单个“o”，而“o+”将匹配所有“o”

### 匹配

-   `.` 匹配除 “\r” “\n” 之外的任何单个字符

-   `(pattern)` 匹配 pattern 并获取这一匹配的子字符串，可以通过 `$x` 形式访问第 x 个子字符串，`x` 为正整数

    获取：存储匹配的子字符串用于 _向后引用_

    -   `(?:pattern)` 匹配 pattern 但作为一个非获取匹配，

        > `industr(?:y|ies)` 比 `industry|industries`

    -   `(?=pattern)` 正向肯定预查（look ahead positive assert），在任何匹配 pattern 的字符串开始处向*左*匹配查找字符串；这是一个非获取匹配；

        预查不消耗字符：在一个匹配发生后，在最后一次匹配之后立即开始下一次匹配的搜索，而不是从包含预查的字符（pattern）之后开始: 上例中匹配之后，从此 20 后而不是 21、22 后继续匹配

        > `20(?=21|22)`能匹配 2021、2022 中的 20，但不能匹配 2019 中的 20

    *   `(?!pattern)` 正向否定预查（look ahead negative assert），在任何*不*匹配 pattern 的字符串开始处向*左*匹配查找字符串

    *   `(?<=pattern)` 反向（look behind positive assert）肯定预查，与正向肯定预查类似，只是方向相反；

        > `(?<=21|22)20`能匹配 2120、2220 中的 20，但不能匹配 2019 中的 20

    *   `(?<!pattern)` 反向否定预查，与正向否定预查类似，只是方向相反

-   `\num` 向后引用（back-reference）一个子字符串（substring），该子字符串与正则表达式的第 num 个`(pattern)`匹配；其中 num 为正整数

    > `(.)\1` 匹配两个连续的相同字符

*   `x|y` 或

    如果没有包围在`()`里，其范围是整个正则表达式，

    > `z|food`能匹配`z`或`food`，`(?:z|f)ood`则匹配`zood`或`food`

*   `[xyz]` 字符集合（character class）匹配所包含的任意一个字符

    特殊字符仅有反斜线`\`保持特殊含义，用于转义字符，其它特殊字符如星号、加号、各种括号等均作为普通字符

    脱字符 `^` 如果出现在首位则表示负值字符集合；如果出现在字符串中间就仅作为普通字符

    连字符 `-` 如果出现在字符串中间表示字符范围描述；如果如果出现在首位（或末尾）则仅作为普通字符

    右方括号应转义出现，也可以作为首位字符出现

    > `[abc]`可以匹配`plain`中的`a`

    -   `[^xyz]` 排除型字符集合（negated character classes）；匹配未列出的任意字符；

        > `[^abc]`可以匹配`plain`中的`plin`

    -   `[a-z]` 字符范围；匹配指定范围内的任意字符；

        > `[a-z]`可以匹配`a`到`z`范围内的任意小写字母字符

    -   `[^a-z]` 排除型的字符范围；匹配任何不在指定范围内的任意字符；

        > `[^a-z]`可以匹配任何不在`a`到`z`范围内的任意字符

*   `\b` 匹配一个单词边界，也就是指单词和空格间的位置

    > `er\b`可以匹配`never`中的`er`，但不能匹配`verb`中的`er`

*   `\B` 匹配非单词边界

*   `\c某` 匹配由 _某_ 指明的控制字符；x 的值必须为 A-Z 或 a-z 之一

    > `\cM` 匹配一个 `Control-M`

*   `\x某某` 十六进制转义字符序列；匹配两个十六进制数字 _某某_ 表示的字符

    正则表达式中可以使用 ASCII 编码

    > `\x41`匹配`A`

*   `\d` 匹配一个数字字符，等价于[0-9]

*   `\D` 匹配一个非数字字符，等价于[^0-9]

*   `\f` 匹配一个换页符，等价于`\x0c` 和 `\cL`

*   `\n` 匹配一个换行符，等价于`\x0a` 和 `\cJ`

*   `\r` 匹配一个回车符，等价于`\x0d` 和 `\cM`

*   `\s` 匹配任何空白字符，包括空格、制表符、换页符等等；等价于`[ \f\n\r\t\v]`

*   `\S` 匹配任何非空白字符；等价于`[^ \f\n\r\t\v]`

*   `\t` 匹配一个制表符，等价于`\x09`和`\cI`

*   `\v` 匹配一个垂直制表符，等价于`\x0b`和`\cK`

*   `\w` 匹配包括下划线的任何单词字符，等价于`[A-Za-z0-9_]`

*   `\W` 匹配任何非单词字符，等价于`[^a-za-z0-9_]`

*   `\u某某某某` Unicode 转义字符序列；其中 _某某某某_ 是一个用四个十六进制数字表示的 Unicode 字符

    > 例如：\u00A9 匹配著作权符号（©）

### 其他

-   `[:name:]` 增加命名字符类（named character class）中的字符到表达式；只能用于方括号表达式

    > `[:upper:]`会匹配大写字母，具体使用：[Character-Classes-and-Bracket-Expressions](https://www.gnu.org/software/grep/manual/html_node/Character-Classes-and-Bracket-Expressions.html#Character-Classes-and-Bracket-Expressions)

<!-- -   `[=elt=]` 增加当前 locale 下排序（collate）等价于字符“elt”的元素

    只能用于方括号表达式

    **例如：[=a=]可能会增加 ä、á、à、ă、ắ、ằ、ẵ、ẳ、â、ấ、ầ、ẫ、ẩ、ǎ、å、ǻ、ä、ǟ、ã、ȧ、ǡ、ą、ā、ả、ȁ、ȃ、ạ、ặ、ậ、ḁ、ⱥ、ᶏ、ɐ、ɑ **

-   `[.elt.]` 增加排序元素（collation element）elt 到表达式中；这是因为某些排序元素由多个字符组成

    只能用于方括号表达式

    **例如：29 个字母表的西班牙语， "CH"作为单个字母排在字母 C 之后，因此会产生如此排序“cinco，credo，chispa”**

-   `\n` 标识一个八进制转义值或一个向后引用；如果\n 之前至少 n 个获取的子表达式，则 n 为向后引用；否则，如果 n 为八进制数字（0-7），则 n 为一个八进制转义值

-   `\nm` 3 位八进制数字，标识一个八进制转义值或一个向后引用；如果\nm 之前至少有 nm 个获得子表达式，则 nm 为向后引用；如果\nm 之前至少有 n 个获取，则 n 为一个后跟文字 m 的向后引用；如果前面的条件都不满足，若 n 和 m 均为八进制数字（0-7），则\nm 将匹配八进制转义值 nm

-   `\nml` 如果 n 为八进制数字（0-3），且 m 和 l 均为八进制数字（0-7），则匹配八进制转义值 nml -->

## 优先权

-   最高：`\`

-   高：`()、(?:)、(?=)、[]`

-   中：`*、+、?、{n}、{n,}、{n,m}`

-   低：`^、\$`

-   次最低：`串接，即相邻字符连接在一起`

-   最低：`|`

# 通配符（WildCard）

于 Shell 等内匹配 文件名 或 目录名

-   `*` 匹配任意字符任意次

-   `?` 匹配任意字符一次

-   `[某-某]` 匹配指定范围内字符

-   `[某某某]` 匹配其中任意字符

-   `[^某]` 匹配无其中任意字符

-   `~` 本用户的家目录

-   `~某` 某用户的家目录
